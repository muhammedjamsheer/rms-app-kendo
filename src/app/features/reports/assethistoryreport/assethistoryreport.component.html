<div class="card card-info" style="height: calc(100% - 5px);width: 100%; min-width: max-content;" [hidden]="showReport">
  <div class="card-header">
    <h3 class="card-title">Asset History Summary Report</h3>

  </div>
<div class="card-body col-md-12" >
  <org-fat-reportsfilterform></org-fat-reportsfilterform>
</div>
</div>

<div class="card card-info" [hidden]="isDetailHidden" style="height: calc(100% - 5px);" [hidden]="!showReport">
    <div class="card-header">
      <h3 class="card-title">Asset History Summary Report</h3>
  
    </div>

    <div class="card-body col-md-12" >
      <div class="tab-content" id="custom-tabs-two-tabContent">
  
        <div id="custom-tabs-two-home" role="tabpanel" aria-labelledby="custom-tabs-two-home-tab">
          <form [formGroup]="AssetHistoryReportForm" class="form-horizontal">
  
            <div class="row form-group">
              <button type="button" (click)="ShowGrid()" class="btn btn-danger btn-sm">
                <i class="fa fa-long-arrow-alt-left" aria-hidden="true"></i> Back
              </button>
              <button type="button" [disabled]="!assetHistoryReportSummary.length" (click)="exportexcelsummary()"
                class="btn btn-success btn-sm">
                <i class="fa fa-download" aria-hidden="true"></i> Download as Excel
              </button>
              <button type="button" (click)="ClearSummary()" class="btn btn-primary btn-sm">
                <i class="fa fa-broom " aria-hidden="true "></i> Clear
              </button>
  
  
            </div>
            <div class="row">
                <div class="col d-flex justify-content-start">
                  <label class="col-sm-8">Total Count: &nbsp; {{assetHistoryReportSummary.length}}</label> 
                </div>
                <div class="col d-flex justify-content-end">
                  Search: &nbsp;
                  <input type="text" placeholder="Search SerialNo" (keyup)="SearchValue($event)" formControlName="SearchInputSummary" class="form-control col-sm-5  ">
                </div>
               
              </div>
            <div class="row form-group tableFixHead" id="excelsummarydiv">
              <table class="table table-bordered canvas_summary_pdf" id="excelsummary" #excelsummary>
                <tbody>
                  <tr>
                    <th>
                        Serial No
                      </th>
                      <th>
                        AssetCategory Name
                      </th>
                      <th>
                        Asset Sub Category Name
                      </th>
                    <th>
                      Product Code
                    </th>
                    <th>
                      Product Name
                    </th>
                    <th>
                      Product Description
                    </th>
                    <th>
                      Brand Name
                    </th>
                    <th>
                      Model Name
                    </th>
                    <th>
                      Supplier Name
                    </th>
                    <th>
                      Manufacture Part No
                    </th>
                    <th>
                      Manufacture Serial No
                    </th>
                    <th>
                      External Tag No
                    </th>
                    <th>
                      Purchase Price
                    </th>
                    <th>
                      Asset Owner
                    </th>
                    <th>
                      Department Name
                    </th>
                    <th>
                      Employee Name
                    </th>
                    <th>
                      Location Name
                    </th>
                    <th>
                      Insurance Name
                    </th>
                    <th>
                      Insurance Value
                    </th>
                    <th>
                      Asset Status
                    </th>
                    <th>
                      Asset Condition
                    </th>
                    <th>
                      Asset Active
                    </th>
                    <th>
                      Depreciation Required
                    </th>
                  </tr>
                  <tr *ngFor="let x1 of assetHistoryReportSummary;let indexofsummary=index">
                    <td>
                        <a href="javascript:void(0)" style="text-decoration: underline;" (click)="ShowItemDetail(x1,indexofsummary)"> {{x1.serialNo}}</a>
                      </td>
                      <td>
                        {{x1.assetCategoryName}}
                      </td>
                      <td>
                        {{x1.assetSubCategoryName}}
                      </td>
                    <td>
                      {{x1.productCode}}
                    </td>
                    <td>
                      {{x1.productName}}
                    </td>
                    <td>
                      {{x1.productDescription}}
                    </td>
                    <td>
                      {{x1.brandName}}
                    </td>
                    <td>
                      {{x1.modelName}}
                    </td>
                    <td>
                      {{x1.supplierName}}
                    </td>
                    <td>
                      {{x1.manufacturePartNo}}
                    </td>
                    <td>
                      {{x1.manufactureSerialNo}}
                    </td>
                    <td>
                      {{x1.extrlTagNumber}}
                    </td>
                    <td>
                      {{x1.purchasePrice}}
                    </td>
                    <td>
                      {{x1.assetOwner}}
                    </td>
                    <td>
                      {{x1.departmentName}}
                    </td>
                    <td>
                      {{x1.employeeName}}
                    </td>
                    <td>
                      {{x1.locationName}}
                    </td>
                    <td>
                      {{x1.insuranceName}}
                    </td>
                    <td>
                      {{x1.insuranceValue}}
                    </td>
                    <td>
                      {{x1.assetStatusName}}
                    </td>
                    <td>
                      {{x1.assetConditionName}}
                    </td>
                    <td>
                      {{x1.assetActive}}
                    </td>
                    <td>
                      {{x1.depreciationRequired}}
                    </td>
                  </tr>
  
  
                </tbody>
              </table>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <div class="card card-info" [hidden]="!isDetailHidden" style="height: calc(100% - 5px);">
    <div class="card-header">
      <h3 class="card-title">Asset History Detail Report</h3>
  
    </div>
    <div class="card-body col-md-12">
      <div class="tab-content" id="custom-tabs-two-tabContent">
  
        <div id="custom-tabs-two-home" role="tabpanel" aria-labelledby="custom-tabs-two-home-tab">
          <form [formGroup]="AssetHistoryReportForm" class="form-horizontal">
  
            <div class="row form-group">
              <button type="button" (click)="ShowSummary()" class="btn btn-danger btn-sm">
                <i class="fa fa-long-arrow-alt-left" aria-hidden="true"></i> Back
              </button>
              <button type="button" [disabled]="!assetHistoryReportDetail.length" (click)="exportexcelDetail()"
                class="btn btn-success btn-sm">
                <i class="fa fa-download" aria-hidden="true"></i> Download as Excel
              </button>
           
            </div>
            <div class="row form-group tableFixHead" id="exceldetaildiv">
              <table class="table table-bordered canvas_summary_pdf" id="exceldetail" #exceldetail>
                <tbody>
                  <tr>
                    <th>
                      Transaction Date
                    </th>
                    <th>
                        Serial No
                      </th>
                      <th>
                        AssetCategory Name
                      </th>
                      <th>
                        Asset Sub Category Name
                      </th>
                    <th>
                      Product Code
                    </th>
                    <th>
                      Product Name
                    </th>
                    <th>
                      Product Description
                    </th>
                    <th>
                      Brand Name
                    </th>
                    <th>
                      Model Name
                    </th>
                    <th>
                      Supplier Name
                    </th>
                    <th>
                      Manufacture Part No
                    </th>
                    <th>
                      Manufacture Serial No
                    </th>
                    <th>
                      External Tag No
                    </th>
                    <th>
                      Purchase Price
                    </th>
                    <th>
                      Asset Owner
                    </th>
                    <th>
                      Department Name
                    </th>
                    <th>
                      Employee Name
                    </th>
                    <th>
                      Site Name
                    </th>
                    <th>
                      Building Name
                    </th>
                    <th>
                      Room Name
                    </th>
                    <th>
                      Location Name
                    </th>
                    <th>
                      Insurance Name
                    </th>
                    <th>
                      Insurance Value
                    </th>
                    <th>
                      Insurance Start Date
                    </th>
                    <th>
                      Insurance End Date
                    </th>
                    <th>
                      Warranty Cost
                    </th>
                    <th>
                      Warranty Start Date
                    </th>
                    <th>
                      Warranty End Date
                    </th>
                    <th>
                     Disposal Amount
                    </th>
                    <th>
                      Disposal Date
                     </th>
                     <th>
                      Disposal Comment
                     </th>
                    <th>
                      Asset Status
                    </th>
                    <th>
                      Asset Condition
                    </th>
                  </tr>
                  <tr *ngFor="let x1 of assetHistoryReportDetail;let indexofsummary=index">
                    <td>
                      {{x1.createdDate | date:'dd-MM-yyyy HH:mm:ss'}}
                   </td>
                    <td>
                         {{x1.serialNo}}
                      </td>
                      <td>
                        {{x1.assetCategoryName}}
                      </td>
                      <td>
                        {{x1.assetSubCategoryName}}
                      </td>
                    <td>
                      {{x1.productCode}}
                    </td>
                    <td>
                      {{x1.productName}}
                    </td>
                    <td>
                      {{x1.productDescription}}
                    </td>
                    <td>
                      {{x1.brandName}}
                    </td>
                    <td>
                      {{x1.modelName}}
                    </td>
                    <td>
                      {{x1.supplierName}}
                    </td>
                    <td>
                      {{x1.manufacturePartNo}}
                    </td>
                    <td>
                      {{x1.manufactureSerialNo}}
                    </td>
                    <td>
                      {{x1.extrlTagNumber}}
                    </td>
                    <td>
                      {{x1.purchasePrice}}
                    </td>
                    <td>
                      {{x1.assetOwner}}
                    </td>
                    <td>
                      {{x1.departmentName}}
                    </td>
                    <td>
                      {{x1.employeeName}}
                    </td>
                    <td>
                      {{x1.siteName}}
                    </td>
                    <td>
                      {{x1.buildingName}}
                    </td>
                    <td>
                      {{x1.roomName}}
                    </td>
                    <td>
                      {{x1.locationName}}
                    </td>
                    <td>
                      {{x1.insuranceName}}
                    </td>
                    <td>
                      {{x1.insuranceValue}}
                    </td>
                    <td>
                      {{x1.insuranceStartDate | date:'dd-MM-yyyy'}}
                    </td>
                    <td>
                      {{x1.insuranceEndDate | date:'dd-MM-yyyy'}}
                    </td>
                    <td>
                      {{x1.warrantyCost}}
                    </td>
                    <td>
                      {{x1.warrantyStartDate | date:'dd-MM-yyyy'}}
                    </td>
                    <td>
                      {{x1.warrantyEndDate | date:'dd-MM-yyyy'}}
                    </td>
                    <td>
                      {{x1.disposalAmount}}
                    </td>
                    <td>
                      {{x1.disposalDate | date:'dd-MM-yyyy'}}
                    </td>
                    <td>
                      {{x1.disposalComment}}
                    </td>
                    <td>
                      {{x1.assetStatusName}}
                    </td>
                    <td>
                      {{x1.assetConditionName}}
                    </td>
                   
                  </tr>
  
  
                </tbody>
              </table>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>